<div class="mine albums">
<%= render "/mine/sub_nav", :action => params[:action] %>
<div class="clear"></div>

<div class="title_btn">
  <div class="btn_action">
    <a href="<%= url_for(:action => :edit, :album_id => @album.id)%>" class="btn_gray mr5">
      <span>编辑相册属性</span>
    </a>
    <a href="<%= url_for(:action => :upload, :album_id => params[:album_id]) %>" class="btn_gray mr5">
      <span>添加照片</span>
    </a>
    <a href="<%= url_for(:action => :index) %>" class="btn_gray">
      <span>返回相册首页</span>
    </a>
  </div>
  <h1><%= @album.name %> <span class="font12">(共<%= @album.photos_num%>张)</span></h1>
  <div class="clear"></div>
</div>


<ul class="photo_list">
  <% @photos.each_with_index do |photo, i| %>
    <li>
      <a href="<%= url_for :action => 'photo', :album_id => @album.id, :index => i %>">
        <%= image_tag photo.image_url( :normal ), :class => 'cover' %>
      </a>
      <% if photo.intro.present? %>
        <p class="intro">
          <% if @is_owner %>
          <%= best_in_place photo, :intro, {:path => {:action => 'update_photo_intro', :photo_id => photo.id } } %>
          <% else %>
          <%= photo.intro %>
          <% end %>
        </p>
      <% elsif @is_owner %>
        <p class="intro">
          <%= best_in_place photo, :intro, { :nil => '点击添加描述', :path => {:action => 'update_photo_intro', :photo_id => photo.id} } %>
        </p>
      <% end %>
      <p class="info">
        <%= photo.created_at.strftime '%Y-%m-%d'%> 上传 | 
        <a href="<%= url_for :action => 'delete_photo', :photo_id => photo.id %>" class="fancybox_delete_photo fancybox.ajax">删除</a><br/>
      <%= photo.viewed_num%>浏览 | <%= photo.commented_num%>评论 | 2赞
      </p>
    </li>
  <% end %>
  <div class="clear"></div>
</ul>

<div class="pagination">
 <%= paginate @photos, :outer_window => 2 %>
</div>
<div class="bottom_action_space clearfix mt20">
  <% if @is_owner && @album.name != 'avatar' %>
  <a href="<%= url_for :action => 'delete', :album_id => @album.id %>" class="fancybox_delete_photo fancybox.ajax button_gray float_r"><span>删除相册</span></a>
  <% end %>
  <span class="mr10">分享到</span>
  <span class="icon_like" href="#">(13)</span>
</div>
<%= form_tag :action => 'delete_photo', :method => 'post' do %>
<input type="hidden" name="photo_id" id="delete_photo_id"/>
<% end %>
<script type="text/javascript">
$('.fancybox_delete_photo').fancybox({padding:0, margin: 0, width: 450, height: 'auto', autoSize: false, modal: true});

function delete_upload_photo( id ){
  $('#delete_photo_id').val( id ).parent().submit();
};

$('.best_in_place').best_in_place();
</script>
<!-- end mine -->
</div>